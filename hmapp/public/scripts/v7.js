var alreadyRunFlag=0;function replaceMacLinks(){if(alreadyRunFlag==0){if(!(document.location.href.match(".ee"))){var theMac="Mac";if(navigator.appVersion.indexOf(theMac)!=-1){for(i=0;i<document.links.length;i++){var theLink=document.links[i].href;if(theLink.match(".exe")){document.links[i].href=theLink.replace(/\.exe/,'.pkg.zip');}}}}}}
if(document.addEventListener){document.addEventListener("DOMContentLoaded",function(){replaceMacLinks()},false);}
else if(document.all&&!window.opera){document.write('<script type="text/javascript" id="contentloadtag" defer="defer" src="javascript:void(0)"><\/script>')
var contentloadtag=document.getElementById("contentloadtag")
contentloadtag.onreadystatechange=function(){if(this.readyState=="complete"){alreadyRunFlag=1;replaceMacLinks();}}}
var nfk={_UID:0,_opacityObjFix:function(a){var b=a.opacity/100;a.MozOpacity=b;a.KhtmlOpacity=b;a.filter="alpha(opacity="+a.opacity+")";a.opacity=b;a.zoom=1;},_getElementsByClassName:function(){var b=[];var c=new RegExp('\\b'+arguments[0]+'\\b');var d=(arguments[1]?arguments[1]:document).getElementsByTagName('*');for(var e=0;e<d.length;e++){if(c.test(d[e].className))b.push(d[e]);};return b;},paths:{server:"",site:"",resources:"http://www.psimg.com/"},files:{},globalFunctions:{gE:function(){return(arguments.length==1?document:arguments[1]).getElementById(arguments[0]);},gES:function(){return(arguments.length==1?document:arguments[1]).getElementsByTagName(arguments[0]);},gUID:function(){nfk._UID++;return"nfk"+nfk._UID.toString(16)},mC:function(strClassToMatch,Element){this.longName="matchClass";return Element.className.match(new RegExp("\\b"+strClassToMatch+"\\b"))?true:false},aC:function(strClassToAdd,Element){!nfk.globalFunctions.mC(strClassToAdd,Element)?Element.className+=(Element.className.length>0)?" "+strClassToAdd:strClassToAdd:null;},rC:function(strClassToRemove,Element){nfk.globalFunctions.mC(strClassToRemove,Element)?Element.className=Element.className.replace(new RegExp("[ \t]*"+strClassToRemove+"($)"),""):null;},aE:function(a,b,c){if(a.addEventListener){a.addEventListener(b,c,false);}else if(a.attachEvent){a.attachEvent("on"+b,c);}else{!a.getAttribute("on"+b)?a.setAttribute("on"+b,c):a.setAttribute('function(){'+a.getAttribute("on"+b)+'};'+c)};return a;},dE:function(a,b,c){if(a.addEventListener){a.removeEventListener(b,c,false)}else if(a.detachEvent){a.detachEvent('on'+b,c)}else{a['on'+b]=null}return a},cE:function(a,b){var c=document.createElement(a);if(b){this.sO(c,b)};return c;},sO:function(a,b){if(b){if(b.opacity){nfk._opacityObjFix(b)};for(var i in b){(typeof a[i]==="object"&&typeof a[i]!="function")?nfk.globalFunctions.sO(a[i],b[i]):a[i]=b[i]}};return a;},aS:function(a){var b=document.getElementById("nfkCustomStyles");var c=(b)?b:cE("style",{id:"nfkCustomStyles",type:"text/css"});if(!b)nfk.globalFunctions.gES("head")[0].appendChild(c);for(var x=0,xl=a.length;x<xl;x++){(c.styleSheet)?c.styleSheet.cssText+="\n"+a[x]:c.appendChild(document.createTextNode(a[x]));};},hP:function(a,b){while(a!=null){if(a==b){return true};a=a.parentNode;};return false;},aR:function(){var a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP"];if(window.ActiveXObject){for(var b=0,bl=a.length;b<bl;b++){try{return new ActiveXObject(a[b]);}catch(e){}}}else{return(window.XMLHttpRequest)?new XMLHttpRequest():false;}},pI:function(a){return parseInt(a+'')},gP:function(a){try{return a.event?a.event.srcElement.nfk.parent:a.nfk.parent;}catch(e){return a}},nE:function(a){return{event:a,target:a.srcElement?a.srcElement:a.target,to:a.toElement||a.relatedTarget?a.toElement?a.toElement:a.relatedTarget:undefined,from:a.fromElement?a.fromElement:a.target,hasParent:function(b){return nfk.globalFunctions.hP(this.target,b)}};return false},xml:function(a){return{url:a.url,fail:a.fail,success:a.success,parent:a.parent?a.parent:null,method:a.method?a.method:"GET",params:a.params?a.params:null,XMLHTTP:new aR(),stateChange:function(){var a=this.XMLHTTP;if(a.readyState==4){(a.status==200||a.status==0)?this.success.call(this.parent,this.XMLHTTP):this.fail?this.fail.call(this.parent,this.XMLHTTP):null;}},init:function(){var c=this,e=this.method.toUpperCase(),g="",h=this.params,i=this.XMLHTTP;if(h){for(var f=0,fl=h.length;f<fl;f++){if(g.length>0)g+="&";g+=h[f][0]+"="+h[f][1];}};i.onreadystatechange=function(){c.stateChange.call(c);};i.open(e,this.url,true);if(e=="POST"){i.setRequestHeader("Content-type","application/x-www-form-urlencoded");i.setRequestHeader("Content-length",h.length);i.setRequestHeader("Connection","close");};try{i.send(g)}catch(ex){return ex.Number+" : "+ex.Description};function stateChange(b,d){if(b.readyState==4){(b.status==200||b.status==0)?d.success(d):d.fail()}};return this;}}},sZ:function(a){var b=a.replace(/^[0]+/g,"");return parseInt(b===""?0:b)},cD:function(a){var t=a.split("T");var b=t[0].split("-");var c=t[1].substr(0,8).split(":");return new Date(b[0],sZ(b[1])-1,sZ(b[2]),sZ(c[0]),sZ(c[1]),sZ(c[2]));},lS:function(a,b,d){var c=cE("script",{src:a,type:"text/javascript"});if(d)sO(c,{nfk:{parent:d}});if(b)aE(c,nfk.ie?"readystatechange":"load",nfk.ie?function(){if(c.readyState=='complete'||c.readyState=="loaded")b.call(d);}:function(){b.call(d)});gES("body")[0].appendChild(c);}},cookies:{set:function(a,b,c){var d=new Date();d.setDate(d.getDate()+c);var e=escape(b)+(c==null?"":";expires="+d.toUTCString());document.cookie=a+"="+e;},get:function(a){var b=typeof this[a],f="undefined";if(b!=f)return this[a];var c=document.cookie.split(";");if(c){for(var d=0,dl=c.length;d<dl;d++){if(c[d]!=""){var e=c[d].split("=");this[e[0]]=e[1];}};};if(this[a])return this[a];return null;}},windowHeight:function(){return!window.opera?document.documentElement.clientHeight:window.innerHeight;},windowWidth:function(){return!window.opera?document.documentElement.clientWidth:window.innerWidth;},eventHandler:function(a){nfk[a]={funcs:{},add:function(a,b){var c=nfk.globalFunctions.gUID();this.funcs[c]={func:a,ref:b};return c;},remove:function(a){if(typeof this.funcs[a]!="undefined")delete this.funcs[a];},execute:function(){for(var a in this.funcs){this.funcs[a].func.call(this.funcs[a].ref);}}};nfk.globalFunctions.aE(window,a,function(){nfk[a].execute()});},ie:navigator.userAgent.indexOf("MSIE")!=-1?true:false,ieFix:((navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.substr(30,3))<=6)?true:false),Init:function(){if(typeof getElementsByClassName=="undefined"){window["getElementsByClassName"]=nfk._getElementsByClassName;window["gEC"]=nfk._getElementsByClassName;};nfk.eventHandler("resize");nfk.eventHandler("scroll");for(var a in this.globalFunctions){window[a]=this.globalFunctions[a];};}};nfk.Init();var PS={copyObj:function(a){var c=new Object();for(var b in a){c[b]=a[b];};return c;},_newObj:function(a){return this.Objects[a]()},addBaseClass:function(a,b){this.Objects[a]=function(){return new Object(b)}},addCustomisations:function(a,b){this.Customisations[a]=b},Customisations:{},setObject:function(a,b){if(b){for(var c in b){if(typeof a[c]==="object"&&typeof a[c]!="function"){this.setObject(a[c],b[c]);}else{a[c]=b[c];}}}return a;},NewObject:function(a,b){if(typeof PS.Objects[a]!="undefined"){var c=PS.copyObj(PS._newObj.call(PS,a));if(b)PS.setObject(c,b);return c;};return"Not Found"},Objects:{}};PS.addBaseClass("Blogs",{url:null,div:null,temp:null,showDate:false,moreText:"",loading:cE("img",{src:"http://www.psimg.com/img/loading.gif"}),parse:function(a){var b=gES("a",a);for(var c=0,cl=b.length;c<cl;c++){if(b[c].parentNode==a){if(b[c].href.match(/feed\.js$/))return b[c].href;return b[c].href.concat((b[c].href.match(/\/$/))?"":"/");}}},setCallback:function(){if(typeof ps_callback=="undefined")window["ps_callback"]=new Object();var me=this;if(typeof ps_callback.blogfeed=="undefined"){clearTimeout(this.callbackCheck);ps_callback.blogfeed=function(data){me.render.call(me,data)};lS(this.url+"feed.js");}else{this.callbackCheck=setTimeout(function(){me.setCallback.call(me)},100);}},callbackCheck:null,charLimit:200,limit:20,formatPost:function(a){if(a.post.length>this.charLimit){var retVal=a.post.substr(0,a.post.substr(0,this.charLimit).lastIndexOf(" "));return retVal+'... '+((this.moreText!=null)?'<a class="blog_more_link" href="'+a.link+'">'+this.moreText+'</a>':'');};return a;},render:function(data){if(this.loading)if(this.div.contains(this.loading))this.div.removeChild(this.loading);var tl=(data.blogs.length<20)?data.blogs.length:limit;for(var t=0;t<tl;t++){var bDiv=cE("div",{className:"blog_item"});var aLink=cE("a",{href:data.blogs[t].link,target:"_blank"});aLink.appendChild(cE("h3",{className:"blog_title",innerHTML:data.blogs[t].title}));bDiv.appendChild(aLink);if(this.showDate)bDiv.appendChild(cE("span",{className:"blog_date",innerHTML:data.blogs[t].date}));bDiv.appendChild(cE("p",{className:"blog_post",innerHTML:this.formatPost(data.blogs[t])}));this.div.appendChild(bDiv);}
if(mC("scroll",this.div)){if(typeof fleXenv!="undefined"){fleXenv.fleXcrollMain(this.div)}else{aC("flexcroll",this.div)}};},error:function(){this.div.innerHTML=this.temp;},init:function(a){this.url=(typeof a=="object")?this.parse(a):a;this.div=arguments[1]?arguments[1]:a;this.temp=this.div.innerHTML+'';this.div.innerHTML="";if(this.loading)this.div.appendChild(this.loading);this.setCallback();}});PS.addBaseClass("PromoRotator",{gN:function(a,b){try{return b.getElementsByTagName(a)[0].childNodes[0].nodeValue}catch(err){};return"";},container:null,load:function(){new xml({url:"promo.xml",success:this.readPromoXml,parent:this}).init();new xml({url:"rotate.xml",success:this.readRotateXml,parent:this}).init();},elements:{btnNext:cE("a",{href:"javascript:void(0)",title:"Next Promotion",innerHTML:" ",className:"promo_next_btn",style:{zIndex:1000}}),btnPrev:cE("a",{href:"javascript:void(0)",title:"Previous Promotion",innerHTML:" ",className:"promo_prev_btn",style:{zIndex:1000}}),promotions:cE("div",{id:"promotions",style:{position:"absolute",top:0,left:"27px",height:"213px",width:"471px",zIndex:100}})},readPromoXml:function(data){var tEnd=false;var cPromo=data.responseXML.getElementsByTagName("promos")[0].firstChild;while(!tEnd){tEnd=cPromo.nextSibling?false:true;if(cPromo.nodeType!=3){this.promos[this.gN("name",cPromo)]={img:this.gN("image",cPromo),txt:this.gN("text",cPromo),url:this.gN("url",cPromo),txtColor:this.gN("textcolor",cPromo),nWin:this.gN("newwindow",cPromo),tPad:this.gN("textpadding",cPromo),align:this.gN("align",cPromo)};};cPromo=cPromo.nextSibling;}
this.loaded.promo=true;this.afterXmlLoad();},interval:null,delay:5000,readRotateXml:function(data){var cNode=data.responseXML.getElementsByTagName("rotation")[0];for(var t=0,tl=cNode.childNodes.length;t<tl;t++){if(cNode.childNodes[t].nodeType!=3){cNode=cNode.childNodes[t];t=tl;}}
var tEnd=false;while(!tEnd){tEnd=cNode.nextSibling?false:true;if(cNode.nodeType!=3){var tNode=cNode.firstChild;var nEnd=false;var nArr=[];while(!nEnd){nEnd=tNode.nextSibling?false:true;if(tNode.nodeType!=3)nArr.push(tNode.childNodes[0].nodeValue);tNode=tNode.nextSibling;};if(nArr.length>0)this.rotate.push(nArr);};cNode=cNode.nextSibling;}
this.loaded.rotate=true;this.afterXmlLoad();},loaded:{promo:false,rotate:false},afterXmlLoad:function(){var me=this;if(this.loaded.promo&&this.loaded.rotate){for(var x=0,xl=this.rotate.length;x<xl;x++){this.buildFrame(this.rotate[x]);}
this.frames[0].style.display="block";this.interval=setInterval(function(){me.nextFrame.call(me)},me.delay);}},currentFrame:0,promos:{},rotate:[],frames:[],buildFrame:function(a){var ul=cE("ul",{style:{position:"absolute",top:0,left:0,display:"none",padding:0,margin:0,width:"471px",listStyle:"none"}});if(a.length==3){for(var x=0;x<3;x++){p=this.promos[a[x]];var li=cE("li",{style:{display:"block",padding:0,margin:0,position:"relative"}});var lnk=cE("a",{href:p.url,style:{display:"block",width:"157px",height:"213px",position:"relative"}});if(p.nWin=="true")lnk.setAttribute("target","_blank");var img=cE("img",{src:p.img,width:"157",height:"213",alt:p.txt});var spn=cE("span",{innerHTML:p.txt,style:{position:"absolute",left:0,top:p.tPad+"px",color:"#"+p.txtColor,display:"block",width:"144px",padding:"10px 3px 0 3px",margin:"0 auto",textAlign:"center"}});lnk.appendChild(img);lnk.appendChild(spn);li.appendChild(lnk);ul.appendChild(li);}}else{}
this.frames.push(ul);this.elements.promotions.appendChild(ul);},nextFrame:function(){this.frames[this.currentFrame].style.display="none";this.currentFrame=(this.currentFrame+1>=this.frames.length)?0:this.currentFrame+1;this.frames[this.currentFrame].style.display="block";},prevFrame:function(){this.frames[this.currentFrame].style.display="none";this.currentFrame=(this.currentFrame-1<=0)?this.frames.length-1:this.currentFrame-1;this.frames[this.currentFrame].style.display="block";},showArrows:function(){var d=(this.elements.btnNext.style.display=="none")?"":"none";this.elements.btnNext.style.display==d;this.elements.btnPrev.style.display==d;},init:function(){var me=this;this.container=gE("promosWrapper");this.container.appendChild(this.elements.btnNext);this.container.appendChild(this.elements.btnPrev);aE(this.elements.btnNext,"click",function(){me.nextFrame.call(me);});aE(this.elements.btnPrev,"click",function(){me.prevFrame.call(me);});aE(this.container,"mouseover",function(e){var myE=nE(e);me.elements.btnNext.style.display="block";me.elements.btnPrev.style.display="block";if(hP(myE.to,me.container)){clearInterval(me.interval);}});this.container.removeChild(gE("promos"));this.container.appendChild(this.elements.promotions);aE(this.container,"mouseout",function(e){var myE=nE(e);if(!hP(myE.to,me.container)){me.elements.btnNext.style.display="none";me.elements.btnPrev.style.display="none";clearInterval(me.interval);me.interval=setInterval(function(){me.nextFrame.call(me)},me.delay);};});this.promos={};this.rotate=[];this.frames=[];this.load();}});PS.addBaseClass("TabEngine",{autoParse:true,orignalDiv:null,tabElement:"h2",contentElement:"div",defaultTabStyles:["text","left","right","top","bottom"],navigationStyle:"tabNav",contentStyle:"tabContent",newTab:function(objTabOptions){return{controller:objTabOptions.controller,id:objTabOptions.id,content:objTabOptions.content,button:objTabOptions.button,effect:{show:function(){if(this.loaded!=true&&this.load!=null){this.loaded=true;this.load()};this.content.style.display=""},hide:function(){this.content.style.display="none"}},load:null,loaded:true}},renderTab:function(element){var returnObject=cE("a",{className:element.className,href:"javascript:void(0)"});for(var a=0,al=this.defaultTabStyles.length;a<al;a++){returnObject.appendChild(cE("span",{className:this.defaultTabStyles[a],innerHTML:((a==0)?element.innerHTML:"")}));};return returnObject;},renderContent:function(element){element.style.display="none";return element;},changeTab:function(tabIndex){var tabToShow=this.tabs[tabIndex];if(tabToShow!=this.currentTab){tabToShow.effect.show.call(tabToShow);aC("active",tabToShow.button);if(this.currentTab){this.currentTab.effect.hide.call(this.currentTab);rC("active",this.currentTab.button);};this.currentTab=tabToShow;}},parse:function(){if(this.orignalDiv){var colTabs=[],colContents=[];var currentElement=this.orignalDiv.firstChild;var lastElement=false;while(!lastElement){switch(currentElement.nodeName.toUpperCase()){case(this.tabElement.toUpperCase()):colTabs.push(currentElement);break;case(this.contentElement.toUpperCase()):colContents.push(currentElement);break;};(currentElement.nextSibling)?currentElement=currentElement.nextSibling:lastElement=true;}
if(colTabs.length==colContents.length){for(var a=0,al=colTabs.length;a<al;a++){var thisTab=this.newTab({controller:this,id:gUID(),content:this.renderContent(colContents[a]),button:this.renderTab(colTabs[a])});this.tabs.push(thisTab);var passThis=this;aE(thisTab.button,"click",(function(a){return function(){passThis.changeTab.call(passThis,a)}})(a));}}else{return"Bad Structure";}}},init:function(a){this.divTabs=null;this.divContents=null;this.tabs=[];this.orignalDiv=a;this.currentTab=null;if(this.autoParse){this.parse();this.divTabs=cE("div",{className:this.navigationStyle});this.divContents=cE("div",{className:this.contentStyle});for(var b=0,bl=this.tabs.length;b<bl;b++){this.divTabs.appendChild(this.tabs[b].button);if(b==0){aC("first",this.tabs[b].button)};if(b==bl-1){aC("last",this.tabs[b].button)};this.divContents.appendChild(this.tabs[b].content);}
this.orignalDiv.innerHTML="";this.orignalDiv.appendChild(this.divTabs);this.orignalDiv.appendChild(this.divContents);this.changeTab(0);}}});aE(window,"load",function(){if(!document.getElementsByTagName)return;var a=document.getElementsByTagName("a");for(var i=0;i<a.length;i++){var e=a[i];if(e.getAttribute("href")&&e.getAttribute("rel")=="external")e.target="_blank";}
var hpTabs=PS.NewObject("TabEngine");var tDiv=gE("Tabs");hpTabs["defaultView"]=tDiv.getElementsByTagName("div")[0];tDiv.removeChild(hpTabs.defaultView);hpTabs.init(tDiv);sO(hpTabs.defaultView,{style:{zIndex:1000,position:"absolute",top:0,left:"1px",display:"block"}});hpTabs.divContents.appendChild(hpTabs.defaultView);for(var i=0,il=hpTabs.tabs.length;i<il;i++){aC("tab"+i,hpTabs.tabs[i].button);aE(hpTabs.tabs[i].button,"mouseover",(function(hpTabs,i){return function(){hpTabs.defaultView.style.display="none";hpTabs.changeTab(i)}})(hpTabs,i));};aE(hpTabs.orignalDiv,"mouseout",function(e){var myE=nE(e);if(!hP(myE.to,hpTabs.orignalDiv))hpTabs.defaultView.style.display="block";});PS.NewObject("PromoRotator").init();lS("http://www.psimg.com/scripts/flexcroll.js",function(){if(typeof fleXenv!="undefined")fleXenv.initByClass("flexcroll");});lS("http://www.psimg.com/scripts/trk.js",function(){if(typeof ps_tracking!="undefined")ps_tracking.init()});lS("scripts/hp-custom.js");});
